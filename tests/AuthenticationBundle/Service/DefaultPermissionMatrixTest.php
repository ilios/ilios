<?php

namespace Tests\AuthenticationBundle\Service;

use Ilios\AuthenticationBundle\Classes\Capabilities;
use Ilios\AuthenticationBundle\Classes\UserRoles;
use Ilios\AuthenticationBundle\Service\DefaultPermissionMatrix;
use Ilios\CoreBundle\Entity\DTO\SchoolDTO;
use Ilios\CoreBundle\Entity\Manager\SchoolManager;
use Mockery as m;
use Symfony\Bundle\FrameworkBundle\Tests\TestCase;

/**
 * Class DefaultPermissionMatrixTest
 * @package Tests\AuthenticationBundle\Service
 * @covers DefaultPermissionMatrix
 */
class DefaultPermissionMatrixTest extends TestCase
{
    use m\Adapter\Phpunit\MockeryPHPUnitIntegration;

    /**
     * @var DefaultPermissionMatrix
     */
    protected $permissionMatrix;

    /**
     * @var SchoolDTO
     */
    protected $schoolDTO;

    /**
     * @inheritdoc
     */
    public function setUp()
    {
        $this->schoolDTO = new SchoolDTO(
            1,
            'School of Test',
            'sot',
            'admin@sot.edu',
            'alerts@sot.edu'
        );
        $schoolManager = m::mock(SchoolManager::class);
        $schoolManager->shouldReceive('findDTOsBy')->andReturn([$this->schoolDTO]);
        $this->permissionMatrix = new DefaultPermissionMatrix($schoolManager);
    }

    /**
     * @inheritdoc
     */
    public function tearDown()
    {
        unset($this->schoolDTO);
        unset($this->permissionMatrix);
    }

    public function hasPermissionProvider()
    {
        return [
            [
                Capabilities::CAN_UPDATE_SCHOOLS,
                [
                    UserRoles::SCHOOL_ADMINISTRATOR,
                    UserRoles::SCHOOL_DIRECTOR,
                ],
                [
                    UserRoles::PROGRAM_DIRECTOR,
                    UserRoles::PROGRAM_YEAR_DIRECTOR,
                    UserRoles::COURSE_ADMINISTRATOR,
                    UserRoles::COURSE_DIRECTOR,
                    UserRoles::COURSE_INSTRUCTOR,
                    UserRoles::SESSION_ADMINISTRATOR,
                    UserRoles::SESSION_INSTRUCTOR,
                    UserRoles::CURRICULUM_INVENTORY_REPORT_ADMINISTRATOR,
                ]
            ],
            [
                Capabilities::CAN_CREATE_PROGRAMS,
                [
                    UserRoles::SCHOOL_ADMINISTRATOR,
                    UserRoles::SCHOOL_DIRECTOR,
                    UserRoles::PROGRAM_DIRECTOR,
                ],
                [
                    UserRoles::PROGRAM_YEAR_DIRECTOR,
                    UserRoles::COURSE_ADMINISTRATOR,
                    UserRoles::COURSE_DIRECTOR,
                    UserRoles::COURSE_INSTRUCTOR,
                    UserRoles::SESSION_ADMINISTRATOR,
                    UserRoles::SESSION_INSTRUCTOR,
                    UserRoles::CURRICULUM_INVENTORY_REPORT_ADMINISTRATOR,
                ]
            ],
            [
                Capabilities::CAN_UPDATE_ALL_PROGRAMS,
                [
                    UserRoles::SCHOOL_ADMINISTRATOR,
                    UserRoles::SCHOOL_DIRECTOR,
                ],
                [
                    UserRoles::PROGRAM_DIRECTOR,
                    UserRoles::PROGRAM_YEAR_DIRECTOR,
                    UserRoles::COURSE_ADMINISTRATOR,
                    UserRoles::COURSE_DIRECTOR,
                    UserRoles::COURSE_INSTRUCTOR,
                    UserRoles::SESSION_ADMINISTRATOR,
                    UserRoles::SESSION_INSTRUCTOR,
                    UserRoles::CURRICULUM_INVENTORY_REPORT_ADMINISTRATOR,
                ]
            ],
            [
                Capabilities::CAN_UPDATE_THEIR_PROGRAMS,
                [
                    UserRoles::PROGRAM_DIRECTOR,
                ],
                [
                    UserRoles::SCHOOL_ADMINISTRATOR,
                    UserRoles::SCHOOL_DIRECTOR,
                    UserRoles::PROGRAM_YEAR_DIRECTOR,
                    UserRoles::COURSE_ADMINISTRATOR,
                    UserRoles::COURSE_DIRECTOR,
                    UserRoles::COURSE_INSTRUCTOR,
                    UserRoles::SESSION_ADMINISTRATOR,
                    UserRoles::SESSION_INSTRUCTOR,
                    UserRoles::CURRICULUM_INVENTORY_REPORT_ADMINISTRATOR,
                ]
            ],
            [
                Capabilities::CAN_DELETE_ALL_PROGRAMS,
                [
                    UserRoles::SCHOOL_ADMINISTRATOR,
                    UserRoles::SCHOOL_DIRECTOR,
                ],
                [
                    UserRoles::PROGRAM_DIRECTOR,
                    UserRoles::PROGRAM_YEAR_DIRECTOR,
                    UserRoles::COURSE_ADMINISTRATOR,
                    UserRoles::COURSE_DIRECTOR,
                    UserRoles::COURSE_INSTRUCTOR,
                    UserRoles::SESSION_ADMINISTRATOR,
                    UserRoles::SESSION_INSTRUCTOR,
                    UserRoles::CURRICULUM_INVENTORY_REPORT_ADMINISTRATOR,
                ]
            ],
            [
                Capabilities::CAN_DELETE_THEIR_PROGRAMS,
                [
                    UserRoles::PROGRAM_DIRECTOR,
                ],
                [
                    UserRoles::SCHOOL_ADMINISTRATOR,
                    UserRoles::SCHOOL_DIRECTOR,
                    UserRoles::PROGRAM_YEAR_DIRECTOR,
                    UserRoles::COURSE_ADMINISTRATOR,
                    UserRoles::COURSE_DIRECTOR,
                    UserRoles::COURSE_INSTRUCTOR,
                    UserRoles::SESSION_ADMINISTRATOR,
                    UserRoles::SESSION_INSTRUCTOR,
                    UserRoles::CURRICULUM_INVENTORY_REPORT_ADMINISTRATOR,
                ]
            ],
            [
                Capabilities::CAN_CREATE_PROGRAM_YEARS,
                [
                    UserRoles::SCHOOL_ADMINISTRATOR,
                    UserRoles::SCHOOL_DIRECTOR,
                    UserRoles::PROGRAM_DIRECTOR,
                ],
                [
                    UserRoles::PROGRAM_YEAR_DIRECTOR,
                    UserRoles::COURSE_ADMINISTRATOR,
                    UserRoles::COURSE_DIRECTOR,
                    UserRoles::COURSE_INSTRUCTOR,
                    UserRoles::SESSION_ADMINISTRATOR,
                    UserRoles::SESSION_INSTRUCTOR,
                    UserRoles::CURRICULUM_INVENTORY_REPORT_ADMINISTRATOR,
                ]
            ],
            [
                Capabilities::CAN_UPDATE_ALL_PROGRAM_YEARS,
                [
                    UserRoles::SCHOOL_ADMINISTRATOR,
                    UserRoles::SCHOOL_DIRECTOR,
                    UserRoles::PROGRAM_DIRECTOR,
                ],
                [
                    UserRoles::PROGRAM_YEAR_DIRECTOR,
                    UserRoles::COURSE_ADMINISTRATOR,
                    UserRoles::COURSE_DIRECTOR,
                    UserRoles::COURSE_INSTRUCTOR,
                    UserRoles::SESSION_ADMINISTRATOR,
                    UserRoles::SESSION_INSTRUCTOR,
                    UserRoles::CURRICULUM_INVENTORY_REPORT_ADMINISTRATOR,
                ]
            ],
            [
                Capabilities::CAN_UPDATE_THEIR_PROGRAM_YEARS,
                [
                    UserRoles::PROGRAM_DIRECTOR,
                ],
                [
                    UserRoles::SCHOOL_ADMINISTRATOR,
                    UserRoles::SCHOOL_DIRECTOR,
                    UserRoles::PROGRAM_YEAR_DIRECTOR,
                    UserRoles::COURSE_ADMINISTRATOR,
                    UserRoles::COURSE_DIRECTOR,
                    UserRoles::COURSE_INSTRUCTOR,
                    UserRoles::SESSION_ADMINISTRATOR,
                    UserRoles::SESSION_INSTRUCTOR,
                    UserRoles::CURRICULUM_INVENTORY_REPORT_ADMINISTRATOR,
                ]
            ],
            [
                Capabilities::CAN_DELETE_ALL_PROGRAM_YEARS,
                [
                    UserRoles::SCHOOL_ADMINISTRATOR,
                    UserRoles::SCHOOL_DIRECTOR,
                    UserRoles::PROGRAM_DIRECTOR,
                ],
                [
                    UserRoles::PROGRAM_YEAR_DIRECTOR,
                    UserRoles::COURSE_ADMINISTRATOR,
                    UserRoles::COURSE_DIRECTOR,
                    UserRoles::COURSE_INSTRUCTOR,
                    UserRoles::SESSION_ADMINISTRATOR,
                    UserRoles::SESSION_INSTRUCTOR,
                    UserRoles::CURRICULUM_INVENTORY_REPORT_ADMINISTRATOR,
                ]
            ],
            [
                Capabilities::CAN_DELETE_THEIR_PROGRAM_YEARS,
                [
                    UserRoles::PROGRAM_DIRECTOR,
                ],
                [
                    UserRoles::SCHOOL_ADMINISTRATOR,
                    UserRoles::SCHOOL_DIRECTOR,
                    UserRoles::PROGRAM_YEAR_DIRECTOR,
                    UserRoles::COURSE_ADMINISTRATOR,
                    UserRoles::COURSE_DIRECTOR,
                    UserRoles::COURSE_INSTRUCTOR,
                    UserRoles::SESSION_ADMINISTRATOR,
                    UserRoles::SESSION_INSTRUCTOR,
                    UserRoles::CURRICULUM_INVENTORY_REPORT_ADMINISTRATOR,
                ]
            ],
            [
                Capabilities::CAN_UNLOCK_ALL_PROGRAM_YEARS,
                [
                    UserRoles::SCHOOL_ADMINISTRATOR,
                    UserRoles::SCHOOL_DIRECTOR,
                    UserRoles::PROGRAM_DIRECTOR,
                ],
                [
                    UserRoles::PROGRAM_YEAR_DIRECTOR,
                    UserRoles::COURSE_ADMINISTRATOR,
                    UserRoles::COURSE_DIRECTOR,
                    UserRoles::COURSE_INSTRUCTOR,
                    UserRoles::SESSION_ADMINISTRATOR,
                    UserRoles::SESSION_INSTRUCTOR,
                    UserRoles::CURRICULUM_INVENTORY_REPORT_ADMINISTRATOR,
                ]
            ],
            [
                Capabilities::CAN_UNLOCK_THEIR_PROGRAM_YEARS,
                [
                    UserRoles::PROGRAM_DIRECTOR,
                ],
                [
                    UserRoles::SCHOOL_ADMINISTRATOR,
                    UserRoles::SCHOOL_DIRECTOR,
                    UserRoles::PROGRAM_YEAR_DIRECTOR,
                    UserRoles::COURSE_ADMINISTRATOR,
                    UserRoles::COURSE_DIRECTOR,
                    UserRoles::COURSE_INSTRUCTOR,
                    UserRoles::SESSION_ADMINISTRATOR,
                    UserRoles::SESSION_INSTRUCTOR,
                    UserRoles::CURRICULUM_INVENTORY_REPORT_ADMINISTRATOR,
                ]
            ],
            [
                Capabilities::CAN_UNARCHIVE_ALL_PROGRAM_YEARS,
                [
                    UserRoles::SCHOOL_ADMINISTRATOR,
                    UserRoles::SCHOOL_DIRECTOR,
                    UserRoles::PROGRAM_DIRECTOR,
                ],
                [
                    UserRoles::PROGRAM_YEAR_DIRECTOR,
                    UserRoles::COURSE_ADMINISTRATOR,
                    UserRoles::COURSE_DIRECTOR,
                    UserRoles::COURSE_INSTRUCTOR,
                    UserRoles::SESSION_ADMINISTRATOR,
                    UserRoles::SESSION_INSTRUCTOR,
                    UserRoles::CURRICULUM_INVENTORY_REPORT_ADMINISTRATOR,
                ]
            ],
            [
                Capabilities::CAN_UNARCHIVE_THEIR_PROGRAM_YEARS,
                [
                    UserRoles::PROGRAM_DIRECTOR,
                ],
                [
                    UserRoles::SCHOOL_ADMINISTRATOR,
                    UserRoles::SCHOOL_DIRECTOR,
                    UserRoles::PROGRAM_YEAR_DIRECTOR,
                    UserRoles::COURSE_ADMINISTRATOR,
                    UserRoles::COURSE_DIRECTOR,
                    UserRoles::COURSE_INSTRUCTOR,
                    UserRoles::SESSION_ADMINISTRATOR,
                    UserRoles::SESSION_INSTRUCTOR,
                    UserRoles::CURRICULUM_INVENTORY_REPORT_ADMINISTRATOR,
                ]
            ],
            [
                Capabilities::CAN_CREATE_COURSES,
                [
                    UserRoles::SCHOOL_ADMINISTRATOR,
                    UserRoles::SCHOOL_DIRECTOR,
                ],
                [
                    UserRoles::PROGRAM_DIRECTOR,
                    UserRoles::PROGRAM_YEAR_DIRECTOR,
                    UserRoles::COURSE_ADMINISTRATOR,
                    UserRoles::COURSE_DIRECTOR,
                    UserRoles::COURSE_INSTRUCTOR,
                    UserRoles::SESSION_ADMINISTRATOR,
                    UserRoles::SESSION_INSTRUCTOR,
                    UserRoles::CURRICULUM_INVENTORY_REPORT_ADMINISTRATOR,
                ]
            ],
            [
                Capabilities::CAN_UPDATE_ALL_COURSES,
                [
                    UserRoles::SCHOOL_ADMINISTRATOR,
                    UserRoles::SCHOOL_DIRECTOR,
                    UserRoles::PROGRAM_DIRECTOR,
                ],
                [
                    UserRoles::PROGRAM_YEAR_DIRECTOR,
                    UserRoles::COURSE_ADMINISTRATOR,
                    UserRoles::COURSE_DIRECTOR,
                    UserRoles::COURSE_INSTRUCTOR,
                    UserRoles::SESSION_ADMINISTRATOR,
                    UserRoles::SESSION_INSTRUCTOR,
                    UserRoles::CURRICULUM_INVENTORY_REPORT_ADMINISTRATOR,
                ]
            ],
            [
                Capabilities::CAN_UPDATE_THEIR_COURSES,
                [
                    UserRoles::COURSE_ADMINISTRATOR,
                    UserRoles::COURSE_DIRECTOR,
                ],
                [
                    UserRoles::SCHOOL_ADMINISTRATOR,
                    UserRoles::SCHOOL_DIRECTOR,
                    UserRoles::PROGRAM_DIRECTOR,
                    UserRoles::PROGRAM_YEAR_DIRECTOR,
                    UserRoles::COURSE_INSTRUCTOR,
                    UserRoles::SESSION_ADMINISTRATOR,
                    UserRoles::SESSION_INSTRUCTOR,
                    UserRoles::CURRICULUM_INVENTORY_REPORT_ADMINISTRATOR,
                ]
            ],
            [
                Capabilities::CAN_DELETE_ALL_COURSES,
                [
                    UserRoles::SCHOOL_ADMINISTRATOR,
                ],
                [
                    UserRoles::SCHOOL_DIRECTOR,
                    UserRoles::PROGRAM_DIRECTOR,
                    UserRoles::PROGRAM_YEAR_DIRECTOR,
                    UserRoles::COURSE_ADMINISTRATOR,
                    UserRoles::COURSE_DIRECTOR,
                    UserRoles::COURSE_INSTRUCTOR,
                    UserRoles::SESSION_ADMINISTRATOR,
                    UserRoles::SESSION_INSTRUCTOR,
                    UserRoles::CURRICULUM_INVENTORY_REPORT_ADMINISTRATOR,
                ]
            ],
            [
                Capabilities::CAN_DELETE_THEIR_COURSES,
                [
                ],
                [
                    UserRoles::SCHOOL_ADMINISTRATOR,
                    UserRoles::SCHOOL_DIRECTOR,
                    UserRoles::PROGRAM_DIRECTOR,
                    UserRoles::PROGRAM_YEAR_DIRECTOR,
                    UserRoles::COURSE_ADMINISTRATOR,
                    UserRoles::COURSE_DIRECTOR,
                    UserRoles::COURSE_INSTRUCTOR,
                    UserRoles::SESSION_ADMINISTRATOR,
                    UserRoles::SESSION_INSTRUCTOR,
                    UserRoles::CURRICULUM_INVENTORY_REPORT_ADMINISTRATOR,
                ]
            ],
            [
                Capabilities::CAN_UNLOCK_ALL_COURSES,
                [
                    UserRoles::SCHOOL_ADMINISTRATOR,
                ],
                [
                    UserRoles::SCHOOL_DIRECTOR,
                    UserRoles::PROGRAM_DIRECTOR,
                    UserRoles::PROGRAM_YEAR_DIRECTOR,
                    UserRoles::COURSE_ADMINISTRATOR,
                    UserRoles::COURSE_DIRECTOR,
                    UserRoles::COURSE_INSTRUCTOR,
                    UserRoles::SESSION_ADMINISTRATOR,
                    UserRoles::SESSION_INSTRUCTOR,
                    UserRoles::CURRICULUM_INVENTORY_REPORT_ADMINISTRATOR,
                ]
            ],
            [
                Capabilities::CAN_UNLOCK_THEIR_COURSES,
                [
                    UserRoles::COURSE_ADMINISTRATOR,
                    UserRoles::COURSE_DIRECTOR,
                ],
                [
                    UserRoles::SCHOOL_ADMINISTRATOR,
                    UserRoles::SCHOOL_DIRECTOR,
                    UserRoles::PROGRAM_DIRECTOR,
                    UserRoles::PROGRAM_YEAR_DIRECTOR,
                    UserRoles::COURSE_INSTRUCTOR,
                    UserRoles::SESSION_ADMINISTRATOR,
                    UserRoles::SESSION_INSTRUCTOR,
                    UserRoles::CURRICULUM_INVENTORY_REPORT_ADMINISTRATOR,
                ]
            ],
            [
                Capabilities::CAN_UNARCHIVE_ALL_COURSES,
                [
                    UserRoles::SCHOOL_ADMINISTRATOR,
                ],
                [
                    UserRoles::SCHOOL_DIRECTOR,
                    UserRoles::PROGRAM_DIRECTOR,
                    UserRoles::PROGRAM_YEAR_DIRECTOR,
                    UserRoles::COURSE_ADMINISTRATOR,
                    UserRoles::COURSE_DIRECTOR,
                    UserRoles::COURSE_INSTRUCTOR,
                    UserRoles::SESSION_ADMINISTRATOR,
                    UserRoles::SESSION_INSTRUCTOR,
                    UserRoles::CURRICULUM_INVENTORY_REPORT_ADMINISTRATOR,
                ]
            ],
            [
                Capabilities::CAN_UNARCHIVE_THEIR_COURSES,
                [
                ],
                [
                    UserRoles::SCHOOL_ADMINISTRATOR,
                    UserRoles::SCHOOL_DIRECTOR,
                    UserRoles::PROGRAM_DIRECTOR,
                    UserRoles::PROGRAM_YEAR_DIRECTOR,
                    UserRoles::COURSE_ADMINISTRATOR,
                    UserRoles::COURSE_DIRECTOR,
                    UserRoles::COURSE_INSTRUCTOR,
                    UserRoles::SESSION_ADMINISTRATOR,
                    UserRoles::SESSION_INSTRUCTOR,
                    UserRoles::CURRICULUM_INVENTORY_REPORT_ADMINISTRATOR,
                ]
            ],
            [
                Capabilities::CAN_CREATE_SESSIONS,
                [
                    UserRoles::SCHOOL_ADMINISTRATOR,
                    UserRoles::SCHOOL_DIRECTOR,
                    UserRoles::PROGRAM_DIRECTOR,
                    UserRoles::COURSE_ADMINISTRATOR,
                    UserRoles::COURSE_DIRECTOR,
                ],
                [
                    UserRoles::PROGRAM_YEAR_DIRECTOR,
                    UserRoles::COURSE_INSTRUCTOR,
                    UserRoles::SESSION_ADMINISTRATOR,
                    UserRoles::SESSION_INSTRUCTOR,
                    UserRoles::CURRICULUM_INVENTORY_REPORT_ADMINISTRATOR,
                ]
            ],
            [
                Capabilities::CAN_UPDATE_ALL_SESSIONS,
                [
                    UserRoles::SCHOOL_ADMINISTRATOR,
                    UserRoles::SCHOOL_DIRECTOR,
                    UserRoles::PROGRAM_DIRECTOR,
                    UserRoles::COURSE_ADMINISTRATOR,
                    UserRoles::COURSE_DIRECTOR,
                ],
                [
                    UserRoles::PROGRAM_YEAR_DIRECTOR,
                    UserRoles::COURSE_INSTRUCTOR,
                    UserRoles::SESSION_ADMINISTRATOR,
                    UserRoles::SESSION_INSTRUCTOR,
                    UserRoles::CURRICULUM_INVENTORY_REPORT_ADMINISTRATOR,
                ]
            ],
            [
                Capabilities::CAN_UPDATE_THEIR_SESSIONS,
                [
                    UserRoles::SESSION_ADMINISTRATOR,
                    UserRoles::SESSION_INSTRUCTOR,
                ],
                [
                    UserRoles::SCHOOL_ADMINISTRATOR,
                    UserRoles::SCHOOL_DIRECTOR,
                    UserRoles::PROGRAM_DIRECTOR,
                    UserRoles::PROGRAM_YEAR_DIRECTOR,
                    UserRoles::COURSE_ADMINISTRATOR,
                    UserRoles::COURSE_DIRECTOR,
                    UserRoles::COURSE_INSTRUCTOR,
                    UserRoles::CURRICULUM_INVENTORY_REPORT_ADMINISTRATOR,
                ]
            ],
            [
                Capabilities::CAN_DELETE_ALL_SESSIONS,
                [
                    UserRoles::SCHOOL_ADMINISTRATOR,
                    UserRoles::SCHOOL_DIRECTOR,
                    UserRoles::COURSE_ADMINISTRATOR,
                    UserRoles::COURSE_DIRECTOR,
                ],
                [
                    UserRoles::PROGRAM_DIRECTOR,
                    UserRoles::PROGRAM_YEAR_DIRECTOR,
                    UserRoles::COURSE_INSTRUCTOR,
                    UserRoles::SESSION_ADMINISTRATOR,
                    UserRoles::SESSION_INSTRUCTOR,
                    UserRoles::CURRICULUM_INVENTORY_REPORT_ADMINISTRATOR,
                ]
            ],
            [
                Capabilities::CAN_DELETE_THEIR_SESSIONS,
                [
                ],
                [
                    UserRoles::SCHOOL_ADMINISTRATOR,
                    UserRoles::SCHOOL_DIRECTOR,
                    UserRoles::PROGRAM_DIRECTOR,
                    UserRoles::PROGRAM_YEAR_DIRECTOR,
                    UserRoles::COURSE_ADMINISTRATOR,
                    UserRoles::COURSE_DIRECTOR,
                    UserRoles::COURSE_INSTRUCTOR,
                    UserRoles::SESSION_ADMINISTRATOR,
                    UserRoles::SESSION_INSTRUCTOR,
                    UserRoles::CURRICULUM_INVENTORY_REPORT_ADMINISTRATOR,
                ]
            ],
            [
                Capabilities::CAN_CREATE_COMPETENCIES,
                [
                    UserRoles::SCHOOL_ADMINISTRATOR,
                ],
                [
                    UserRoles::SCHOOL_DIRECTOR,
                    UserRoles::PROGRAM_DIRECTOR,
                    UserRoles::PROGRAM_YEAR_DIRECTOR,
                    UserRoles::COURSE_ADMINISTRATOR,
                    UserRoles::COURSE_DIRECTOR,
                    UserRoles::COURSE_INSTRUCTOR,
                    UserRoles::SESSION_ADMINISTRATOR,
                    UserRoles::SESSION_INSTRUCTOR,
                    UserRoles::CURRICULUM_INVENTORY_REPORT_ADMINISTRATOR,
                ]
            ],
            [
                Capabilities::CAN_UPDATE_COMPETENCIES,
                [
                    UserRoles::SCHOOL_ADMINISTRATOR,
                ],
                [
                    UserRoles::SCHOOL_DIRECTOR,
                    UserRoles::PROGRAM_DIRECTOR,
                    UserRoles::PROGRAM_YEAR_DIRECTOR,
                    UserRoles::COURSE_ADMINISTRATOR,
                    UserRoles::COURSE_DIRECTOR,
                    UserRoles::COURSE_INSTRUCTOR,
                    UserRoles::SESSION_ADMINISTRATOR,
                    UserRoles::SESSION_INSTRUCTOR,
                    UserRoles::CURRICULUM_INVENTORY_REPORT_ADMINISTRATOR,
                ]
            ],
            [
                Capabilities::CAN_DELETE_COMPETENCIES,
                [
                    UserRoles::SCHOOL_ADMINISTRATOR,
                ],
                [
                    UserRoles::SCHOOL_DIRECTOR,
                    UserRoles::PROGRAM_DIRECTOR,
                    UserRoles::PROGRAM_YEAR_DIRECTOR,
                    UserRoles::COURSE_ADMINISTRATOR,
                    UserRoles::COURSE_DIRECTOR,
                    UserRoles::COURSE_INSTRUCTOR,
                    UserRoles::SESSION_ADMINISTRATOR,
                    UserRoles::SESSION_INSTRUCTOR,
                    UserRoles::CURRICULUM_INVENTORY_REPORT_ADMINISTRATOR,
                ]
            ],
            [
                Capabilities::CAN_CREATE_SESSION_TYPES,
                [
                    UserRoles::SCHOOL_ADMINISTRATOR,
                ],
                [
                    UserRoles::SCHOOL_DIRECTOR,
                    UserRoles::PROGRAM_DIRECTOR,
                    UserRoles::PROGRAM_YEAR_DIRECTOR,
                    UserRoles::COURSE_ADMINISTRATOR,
                    UserRoles::COURSE_DIRECTOR,
                    UserRoles::COURSE_INSTRUCTOR,
                    UserRoles::SESSION_ADMINISTRATOR,
                    UserRoles::SESSION_INSTRUCTOR,
                    UserRoles::CURRICULUM_INVENTORY_REPORT_ADMINISTRATOR,
                ]
            ],
            [
                Capabilities::CAN_UPDATE_SESSION_TYPES,
                [
                    UserRoles::SCHOOL_ADMINISTRATOR,
                ],
                [
                    UserRoles::SCHOOL_DIRECTOR,
                    UserRoles::PROGRAM_DIRECTOR,
                    UserRoles::PROGRAM_YEAR_DIRECTOR,
                    UserRoles::COURSE_ADMINISTRATOR,
                    UserRoles::COURSE_DIRECTOR,
                    UserRoles::COURSE_INSTRUCTOR,
                    UserRoles::SESSION_ADMINISTRATOR,
                    UserRoles::SESSION_INSTRUCTOR,
                    UserRoles::CURRICULUM_INVENTORY_REPORT_ADMINISTRATOR,
                ]
            ],
            [
                Capabilities::CAN_DELETE_SESSION_TYPES,
                [
                    UserRoles::SCHOOL_ADMINISTRATOR,
                ],
                [
                    UserRoles::SCHOOL_DIRECTOR,
                    UserRoles::PROGRAM_DIRECTOR,
                    UserRoles::PROGRAM_YEAR_DIRECTOR,
                    UserRoles::COURSE_ADMINISTRATOR,
                    UserRoles::COURSE_DIRECTOR,
                    UserRoles::COURSE_INSTRUCTOR,
                    UserRoles::SESSION_ADMINISTRATOR,
                    UserRoles::SESSION_INSTRUCTOR,
                    UserRoles::CURRICULUM_INVENTORY_REPORT_ADMINISTRATOR,
                ]
            ],
            [
                Capabilities::CAN_CREATE_VOCABULARIES,
                [
                    UserRoles::SCHOOL_ADMINISTRATOR,
                ],
                [
                    UserRoles::SCHOOL_DIRECTOR,
                    UserRoles::PROGRAM_DIRECTOR,
                    UserRoles::PROGRAM_YEAR_DIRECTOR,
                    UserRoles::COURSE_ADMINISTRATOR,
                    UserRoles::COURSE_DIRECTOR,
                    UserRoles::COURSE_INSTRUCTOR,
                    UserRoles::SESSION_ADMINISTRATOR,
                    UserRoles::SESSION_INSTRUCTOR,
                    UserRoles::CURRICULUM_INVENTORY_REPORT_ADMINISTRATOR,
                ]
            ],
            [
                Capabilities::CAN_UPDATE_VOCABULARIES,
                [
                    UserRoles::SCHOOL_ADMINISTRATOR,
                ],
                [
                    UserRoles::SCHOOL_DIRECTOR,
                    UserRoles::PROGRAM_DIRECTOR,
                    UserRoles::PROGRAM_YEAR_DIRECTOR,
                    UserRoles::COURSE_ADMINISTRATOR,
                    UserRoles::COURSE_DIRECTOR,
                    UserRoles::COURSE_INSTRUCTOR,
                    UserRoles::SESSION_ADMINISTRATOR,
                    UserRoles::SESSION_INSTRUCTOR,
                    UserRoles::CURRICULUM_INVENTORY_REPORT_ADMINISTRATOR,
                ]
            ],
            [
                Capabilities::CAN_DELETE_VOCABULARIES,
                [
                    UserRoles::SCHOOL_ADMINISTRATOR,
                ],
                [
                    UserRoles::SCHOOL_DIRECTOR,
                    UserRoles::PROGRAM_DIRECTOR,
                    UserRoles::PROGRAM_YEAR_DIRECTOR,
                    UserRoles::COURSE_ADMINISTRATOR,
                    UserRoles::COURSE_DIRECTOR,
                    UserRoles::COURSE_INSTRUCTOR,
                    UserRoles::SESSION_ADMINISTRATOR,
                    UserRoles::SESSION_INSTRUCTOR,
                    UserRoles::CURRICULUM_INVENTORY_REPORT_ADMINISTRATOR,
                ]
            ],
            [
                Capabilities::CAN_CREATE_TERMS,
                [
                    UserRoles::SCHOOL_ADMINISTRATOR,
                    UserRoles::SCHOOL_DIRECTOR,
                ],
                [
                    UserRoles::PROGRAM_DIRECTOR,
                    UserRoles::PROGRAM_YEAR_DIRECTOR,
                    UserRoles::COURSE_ADMINISTRATOR,
                    UserRoles::COURSE_DIRECTOR,
                    UserRoles::COURSE_INSTRUCTOR,
                    UserRoles::SESSION_ADMINISTRATOR,
                    UserRoles::SESSION_INSTRUCTOR,
                    UserRoles::CURRICULUM_INVENTORY_REPORT_ADMINISTRATOR,
                ]
            ],
            [
                Capabilities::CAN_UPDATE_TERMS,
                [
                    UserRoles::SCHOOL_ADMINISTRATOR,
                    UserRoles::SCHOOL_DIRECTOR,
                ],
                [
                    UserRoles::PROGRAM_DIRECTOR,
                    UserRoles::PROGRAM_YEAR_DIRECTOR,
                    UserRoles::COURSE_ADMINISTRATOR,
                    UserRoles::COURSE_DIRECTOR,
                    UserRoles::COURSE_INSTRUCTOR,
                    UserRoles::SESSION_ADMINISTRATOR,
                    UserRoles::SESSION_INSTRUCTOR,
                    UserRoles::CURRICULUM_INVENTORY_REPORT_ADMINISTRATOR,
                ]
            ],
            [
                Capabilities::CAN_DELETE_TERMS,
                [
                    UserRoles::SCHOOL_ADMINISTRATOR,
                    UserRoles::SCHOOL_DIRECTOR,
                ],
                [
                    UserRoles::PROGRAM_DIRECTOR,
                    UserRoles::PROGRAM_YEAR_DIRECTOR,
                    UserRoles::COURSE_ADMINISTRATOR,
                    UserRoles::COURSE_DIRECTOR,
                    UserRoles::COURSE_INSTRUCTOR,
                    UserRoles::SESSION_ADMINISTRATOR,
                    UserRoles::SESSION_INSTRUCTOR,
                    UserRoles::CURRICULUM_INVENTORY_REPORT_ADMINISTRATOR,
                ]
            ],
            [
                Capabilities::CAN_CREATE_INSTRUCTOR_GROUPS,
                [
                    UserRoles::SCHOOL_ADMINISTRATOR,
                    UserRoles::SCHOOL_DIRECTOR,
                    UserRoles::PROGRAM_DIRECTOR,
                    UserRoles::COURSE_ADMINISTRATOR,
                    UserRoles::COURSE_DIRECTOR,
                ],
                [
                    UserRoles::PROGRAM_YEAR_DIRECTOR,
                    UserRoles::COURSE_INSTRUCTOR,
                    UserRoles::SESSION_ADMINISTRATOR,
                    UserRoles::SESSION_INSTRUCTOR,
                    UserRoles::CURRICULUM_INVENTORY_REPORT_ADMINISTRATOR,
                ]
            ],
            [
                Capabilities::CAN_UPDATE_INSTRUCTOR_GROUPS,
                [
                    UserRoles::SCHOOL_ADMINISTRATOR,
                    UserRoles::COURSE_ADMINISTRATOR,
                    UserRoles::COURSE_DIRECTOR,
                ],
                [
                    UserRoles::SCHOOL_DIRECTOR,
                    UserRoles::PROGRAM_DIRECTOR,
                    UserRoles::PROGRAM_YEAR_DIRECTOR,
                    UserRoles::COURSE_INSTRUCTOR,
                    UserRoles::SESSION_ADMINISTRATOR,
                    UserRoles::SESSION_INSTRUCTOR,
                    UserRoles::CURRICULUM_INVENTORY_REPORT_ADMINISTRATOR,
                ]
            ],
            [
                Capabilities::CAN_DELETE_INSTRUCTOR_GROUPS,
                [
                    UserRoles::SCHOOL_ADMINISTRATOR,
                ],
                [
                    UserRoles::SCHOOL_DIRECTOR,
                    UserRoles::PROGRAM_DIRECTOR,
                    UserRoles::PROGRAM_YEAR_DIRECTOR,
                    UserRoles::COURSE_ADMINISTRATOR,
                    UserRoles::COURSE_DIRECTOR,
                    UserRoles::COURSE_INSTRUCTOR,
                    UserRoles::SESSION_ADMINISTRATOR,
                    UserRoles::SESSION_INSTRUCTOR,
                    UserRoles::CURRICULUM_INVENTORY_REPORT_ADMINISTRATOR,
                ]
            ],
            [
                Capabilities::CAN_CREATE_LEARNER_GROUPS,
                [
                    UserRoles::SCHOOL_ADMINISTRATOR,
                    UserRoles::COURSE_ADMINISTRATOR,
                    UserRoles::COURSE_DIRECTOR,
                    UserRoles::SESSION_ADMINISTRATOR,
                ],
                [
                    UserRoles::SCHOOL_DIRECTOR,
                    UserRoles::PROGRAM_DIRECTOR,
                    UserRoles::PROGRAM_YEAR_DIRECTOR,
                    UserRoles::COURSE_INSTRUCTOR,
                    UserRoles::SESSION_INSTRUCTOR,
                    UserRoles::CURRICULUM_INVENTORY_REPORT_ADMINISTRATOR,
                ]
            ],
            [
                Capabilities::CAN_UPDATE_LEARNER_GROUPS,
                [
                    UserRoles::SCHOOL_ADMINISTRATOR,
                    UserRoles::COURSE_ADMINISTRATOR,
                    UserRoles::COURSE_DIRECTOR,
                    UserRoles::SESSION_ADMINISTRATOR,
                ],
                [
                    UserRoles::SCHOOL_DIRECTOR,
                    UserRoles::PROGRAM_DIRECTOR,
                    UserRoles::PROGRAM_YEAR_DIRECTOR,
                    UserRoles::COURSE_INSTRUCTOR,
                    UserRoles::SESSION_INSTRUCTOR,
                    UserRoles::CURRICULUM_INVENTORY_REPORT_ADMINISTRATOR,
                ]
            ],
            [
                Capabilities::CAN_DELETE_LEARNER_GROUPS,
                [
                    UserRoles::SCHOOL_ADMINISTRATOR,
                ],
                [
                    UserRoles::SCHOOL_DIRECTOR,
                    UserRoles::PROGRAM_DIRECTOR,
                    UserRoles::PROGRAM_YEAR_DIRECTOR,
                    UserRoles::COURSE_ADMINISTRATOR,
                    UserRoles::COURSE_DIRECTOR,
                    UserRoles::COURSE_INSTRUCTOR,
                    UserRoles::SESSION_ADMINISTRATOR,
                    UserRoles::SESSION_INSTRUCTOR,
                    UserRoles::CURRICULUM_INVENTORY_REPORT_ADMINISTRATOR,
                ]
            ],
            [
                Capabilities::CAN_CREATE_CURRICULUM_INVENTORY_REPORTS,
                [
                    UserRoles::SCHOOL_ADMINISTRATOR,
                    UserRoles::SCHOOL_DIRECTOR,
                ],
                [
                    UserRoles::PROGRAM_DIRECTOR,
                    UserRoles::PROGRAM_YEAR_DIRECTOR,
                    UserRoles::COURSE_ADMINISTRATOR,
                    UserRoles::COURSE_DIRECTOR,
                    UserRoles::COURSE_INSTRUCTOR,
                    UserRoles::SESSION_ADMINISTRATOR,
                    UserRoles::SESSION_INSTRUCTOR,
                    UserRoles::CURRICULUM_INVENTORY_REPORT_ADMINISTRATOR,
                ]
            ],
            [
                Capabilities::CAN_UPDATE_ALL_CURRICULUM_INVENTORY_REPORTS,
                [
                    UserRoles::SCHOOL_ADMINISTRATOR,
                    UserRoles::SCHOOL_DIRECTOR,
                ],
                [
                    UserRoles::PROGRAM_DIRECTOR,
                    UserRoles::PROGRAM_YEAR_DIRECTOR,
                    UserRoles::COURSE_ADMINISTRATOR,
                    UserRoles::COURSE_DIRECTOR,
                    UserRoles::COURSE_INSTRUCTOR,
                    UserRoles::SESSION_ADMINISTRATOR,
                    UserRoles::SESSION_INSTRUCTOR,
                    UserRoles::CURRICULUM_INVENTORY_REPORT_ADMINISTRATOR,
                ]
            ],
            [
                Capabilities::CAN_UPDATE_THEIR_CURRICULUM_INVENTORY_REPORTS,
                [
                    UserRoles::CURRICULUM_INVENTORY_REPORT_ADMINISTRATOR,
                ],
                [
                    UserRoles::SCHOOL_ADMINISTRATOR,
                    UserRoles::SCHOOL_DIRECTOR,
                    UserRoles::PROGRAM_DIRECTOR,
                    UserRoles::PROGRAM_YEAR_DIRECTOR,
                    UserRoles::COURSE_ADMINISTRATOR,
                    UserRoles::COURSE_DIRECTOR,
                    UserRoles::COURSE_INSTRUCTOR,
                    UserRoles::SESSION_ADMINISTRATOR,
                    UserRoles::SESSION_INSTRUCTOR,
                ]
            ],
            [
                Capabilities::CAN_DELETE_ALL_CURRICULUM_INVENTORY_REPORTS,
                [
                    UserRoles::SCHOOL_ADMINISTRATOR,
                ],
                [
                    UserRoles::SCHOOL_DIRECTOR,
                    UserRoles::PROGRAM_DIRECTOR,
                    UserRoles::PROGRAM_YEAR_DIRECTOR,
                    UserRoles::COURSE_ADMINISTRATOR,
                    UserRoles::COURSE_DIRECTOR,
                    UserRoles::COURSE_INSTRUCTOR,
                    UserRoles::SESSION_ADMINISTRATOR,
                    UserRoles::SESSION_INSTRUCTOR,
                    UserRoles::CURRICULUM_INVENTORY_REPORT_ADMINISTRATOR,
                ]
            ],
            [
                Capabilities::CAN_DELETE_THEIR_CURRICULUM_INVENTORY_REPORTS,
                [
                ],
                [
                    UserRoles::SCHOOL_ADMINISTRATOR,
                    UserRoles::SCHOOL_DIRECTOR,
                    UserRoles::PROGRAM_DIRECTOR,
                    UserRoles::PROGRAM_YEAR_DIRECTOR,
                    UserRoles::COURSE_ADMINISTRATOR,
                    UserRoles::COURSE_DIRECTOR,
                    UserRoles::COURSE_INSTRUCTOR,
                    UserRoles::SESSION_ADMINISTRATOR,
                    UserRoles::SESSION_INSTRUCTOR,
                    UserRoles::CURRICULUM_INVENTORY_REPORT_ADMINISTRATOR,
                ]
            ],
            [
                Capabilities::CAN_CREATE_SCHOOL_CONFIGS,
                [
                    UserRoles::SCHOOL_ADMINISTRATOR,
                    UserRoles::SCHOOL_DIRECTOR,
                ],
                [
                    UserRoles::PROGRAM_DIRECTOR,
                    UserRoles::PROGRAM_YEAR_DIRECTOR,
                    UserRoles::COURSE_ADMINISTRATOR,
                    UserRoles::COURSE_DIRECTOR,
                    UserRoles::COURSE_INSTRUCTOR,
                    UserRoles::SESSION_ADMINISTRATOR,
                    UserRoles::SESSION_INSTRUCTOR,
                    UserRoles::CURRICULUM_INVENTORY_REPORT_ADMINISTRATOR,
                ]
            ],
            [
                Capabilities::CAN_UPDATE_SCHOOL_CONFIGS,
                [
                    UserRoles::SCHOOL_ADMINISTRATOR,
                    UserRoles::SCHOOL_DIRECTOR,
                ],
                [
                    UserRoles::PROGRAM_DIRECTOR,
                    UserRoles::PROGRAM_YEAR_DIRECTOR,
                    UserRoles::COURSE_ADMINISTRATOR,
                    UserRoles::COURSE_DIRECTOR,
                    UserRoles::COURSE_INSTRUCTOR,
                    UserRoles::SESSION_ADMINISTRATOR,
                    UserRoles::SESSION_INSTRUCTOR,
                    UserRoles::CURRICULUM_INVENTORY_REPORT_ADMINISTRATOR,
                ]
            ],
            [
                Capabilities::CAN_DELETE_SCHOOL_CONFIGS,
                [
                    UserRoles::SCHOOL_ADMINISTRATOR,
                    UserRoles::SCHOOL_DIRECTOR,
                ],
                [
                    UserRoles::PROGRAM_DIRECTOR,
                    UserRoles::PROGRAM_YEAR_DIRECTOR,
                    UserRoles::COURSE_ADMINISTRATOR,
                    UserRoles::COURSE_DIRECTOR,
                    UserRoles::COURSE_INSTRUCTOR,
                    UserRoles::SESSION_ADMINISTRATOR,
                    UserRoles::SESSION_INSTRUCTOR,
                    UserRoles::CURRICULUM_INVENTORY_REPORT_ADMINISTRATOR,
                ]
            ],
            [
                Capabilities::CAN_CREATE_CURRICULUM_INVENTORY_INSTITUTIONS,
                [
                    UserRoles::SCHOOL_ADMINISTRATOR,
                ],
                [
                    UserRoles::SCHOOL_DIRECTOR,
                    UserRoles::PROGRAM_DIRECTOR,
                    UserRoles::PROGRAM_YEAR_DIRECTOR,
                    UserRoles::COURSE_ADMINISTRATOR,
                    UserRoles::COURSE_DIRECTOR,
                    UserRoles::COURSE_INSTRUCTOR,
                    UserRoles::SESSION_ADMINISTRATOR,
                    UserRoles::SESSION_INSTRUCTOR,
                    UserRoles::CURRICULUM_INVENTORY_REPORT_ADMINISTRATOR,
                ]
            ],
            [
                Capabilities::CAN_UPDATE_CURRICULUM_INVENTORY_INSTITUTIONS,
                [
                    UserRoles::SCHOOL_ADMINISTRATOR,
                ],
                [
                    UserRoles::SCHOOL_DIRECTOR,
                    UserRoles::PROGRAM_DIRECTOR,
                    UserRoles::PROGRAM_YEAR_DIRECTOR,
                    UserRoles::COURSE_ADMINISTRATOR,
                    UserRoles::COURSE_DIRECTOR,
                    UserRoles::COURSE_INSTRUCTOR,
                    UserRoles::SESSION_ADMINISTRATOR,
                    UserRoles::SESSION_INSTRUCTOR,
                    UserRoles::CURRICULUM_INVENTORY_REPORT_ADMINISTRATOR,
                ]
            ],
            [
                Capabilities::CAN_DELETE_CURRICULUM_INVENTORY_INSTITUTIONS,
                [
                    UserRoles::SCHOOL_ADMINISTRATOR,
                ],
                [
                    UserRoles::SCHOOL_DIRECTOR,
                    UserRoles::PROGRAM_DIRECTOR,
                    UserRoles::PROGRAM_YEAR_DIRECTOR,
                    UserRoles::COURSE_ADMINISTRATOR,
                    UserRoles::COURSE_DIRECTOR,
                    UserRoles::COURSE_INSTRUCTOR,
                    UserRoles::SESSION_ADMINISTRATOR,
                    UserRoles::SESSION_INSTRUCTOR,
                    UserRoles::CURRICULUM_INVENTORY_REPORT_ADMINISTRATOR,
                ]
            ],
            [
                Capabilities::CAN_CREATE_USERS,
                [
                    UserRoles::SCHOOL_ADMINISTRATOR,
                ],
                [
                    UserRoles::SCHOOL_DIRECTOR,
                    UserRoles::PROGRAM_DIRECTOR,
                    UserRoles::PROGRAM_YEAR_DIRECTOR,
                    UserRoles::COURSE_ADMINISTRATOR,
                    UserRoles::COURSE_DIRECTOR,
                    UserRoles::COURSE_INSTRUCTOR,
                    UserRoles::SESSION_ADMINISTRATOR,
                    UserRoles::SESSION_INSTRUCTOR,
                    UserRoles::CURRICULUM_INVENTORY_REPORT_ADMINISTRATOR,
                ]
            ],
            [
                Capabilities::CAN_UPDATE_USERS,
                [
                    UserRoles::SCHOOL_ADMINISTRATOR,
                ],
                [
                    UserRoles::SCHOOL_DIRECTOR,
                    UserRoles::PROGRAM_DIRECTOR,
                    UserRoles::PROGRAM_YEAR_DIRECTOR,
                    UserRoles::COURSE_ADMINISTRATOR,
                    UserRoles::COURSE_DIRECTOR,
                    UserRoles::COURSE_INSTRUCTOR,
                    UserRoles::SESSION_ADMINISTRATOR,
                    UserRoles::SESSION_INSTRUCTOR,
                    UserRoles::CURRICULUM_INVENTORY_REPORT_ADMINISTRATOR,
                ]
            ],
            [
                Capabilities::CAN_DELETE_USERS,
                [
                    UserRoles::SCHOOL_ADMINISTRATOR,
                ],
                [
                    UserRoles::SCHOOL_DIRECTOR,
                    UserRoles::PROGRAM_DIRECTOR,
                    UserRoles::PROGRAM_YEAR_DIRECTOR,
                    UserRoles::COURSE_ADMINISTRATOR,
                    UserRoles::COURSE_DIRECTOR,
                    UserRoles::COURSE_INSTRUCTOR,
                    UserRoles::SESSION_ADMINISTRATOR,
                    UserRoles::SESSION_INSTRUCTOR,
                    UserRoles::CURRICULUM_INVENTORY_REPORT_ADMINISTRATOR,
                ]
            ],
            [
                Capabilities::CAN_CREATE_DEPARTMENTS,
                [
                    UserRoles::SCHOOL_ADMINISTRATOR,
                    UserRoles::SCHOOL_DIRECTOR,
                ],
                [
                    UserRoles::PROGRAM_DIRECTOR,
                    UserRoles::PROGRAM_YEAR_DIRECTOR,
                    UserRoles::COURSE_ADMINISTRATOR,
                    UserRoles::COURSE_DIRECTOR,
                    UserRoles::COURSE_INSTRUCTOR,
                    UserRoles::SESSION_ADMINISTRATOR,
                    UserRoles::SESSION_INSTRUCTOR,
                    UserRoles::CURRICULUM_INVENTORY_REPORT_ADMINISTRATOR,
                ]
            ],
            [
                Capabilities::CAN_UPDATE_DEPARTMENTS,
                [
                    UserRoles::SCHOOL_ADMINISTRATOR,
                    UserRoles::SCHOOL_DIRECTOR,
                ],
                [
                    UserRoles::PROGRAM_DIRECTOR,
                    UserRoles::PROGRAM_YEAR_DIRECTOR,
                    UserRoles::COURSE_ADMINISTRATOR,
                    UserRoles::COURSE_DIRECTOR,
                    UserRoles::COURSE_INSTRUCTOR,
                    UserRoles::SESSION_ADMINISTRATOR,
                    UserRoles::SESSION_INSTRUCTOR,
                    UserRoles::CURRICULUM_INVENTORY_REPORT_ADMINISTRATOR,
                ]
            ],
            [
                Capabilities::CAN_DELETE_DEPARTMENTS,
                [
                    UserRoles::SCHOOL_ADMINISTRATOR,
                    UserRoles::SCHOOL_DIRECTOR,
                ],
                [
                    UserRoles::PROGRAM_DIRECTOR,
                    UserRoles::PROGRAM_YEAR_DIRECTOR,
                    UserRoles::COURSE_ADMINISTRATOR,
                    UserRoles::COURSE_DIRECTOR,
                    UserRoles::COURSE_INSTRUCTOR,
                    UserRoles::SESSION_ADMINISTRATOR,
                    UserRoles::SESSION_INSTRUCTOR,
                    UserRoles::CURRICULUM_INVENTORY_REPORT_ADMINISTRATOR,
                ]
            ],
        ];
    }

    /**
     * @dataProvider hasPermissionProvider
     */
    public function testHasPermission($capability, array $allowedRoles, array $deniedRoles)
    {
        $this->assertEquals(count($allowedRoles) +  count($deniedRoles), 10);
        foreach ($allowedRoles as $role) {
            $this->assertTrue(
                $this->permissionMatrix->hasPermission(
                    $this->schoolDTO->id,
                    $capability,
                    [ $role ]
                )
            );
        }

        foreach ($deniedRoles as $role) {
            $this->assertFalse(
                $this->permissionMatrix->hasPermission(
                    $this->schoolDTO->id,
                    $capability,
                    [ $role ]
                )
            );
        }
    }
}
